# 👁️ UI-Eye 视觉走查机器人 - 使用指南

欢迎使用 UI-Eye！本项目是一款基于 **TypeScript + DDD 架构** 开发的自动化视觉走查工具。

提供三种核心能力：**单页即时比对**、**全站批量任务** 以及 **Chrome 插件实时取色走查**。

---

## 1. 快速启动 (Quick Start)

项目采用前后端分离架构，通过 WebSocket 实现任务进度的实时追踪。

### 环境准备
- Node.js >= 18
- 浏览器 (推荐 Chrome/Edge)

### 后端服务 (Server)
```bash
# 进入服务端目录
cd server
cp .env.example .env # 配置您的 AI Key
npm install
npm run dev # 启动在 http://localhost:3000
```

### 前端控制台 (Web)
```bash
# 进入 Web 目录
cd web
npm install
npm run dev # 访问：http://localhost:5173
```

---

## 2. 核心工作流

### 方案 A：单页即时比对 (适用于快速验证)
1. 在首页点击 **“开始对比”**。
2. 输入 H5 页面链接，并上传关联的设计稿 (PNG/JPG)。
3. 系统将驱动 Puppeteer 完成截图，并调用 **ODiff 引擎** 执行像素级比对。
4. 在报告详情页，点击左侧的“差异区域”即可查看 AI 针对该位置给出的 CSS 修复建议。

### 方案 B：全站批量走查流水线 (适用于多链接监控)
1. 进入 **“批量任务”** 页面。
2. 点击 **“创建新任务”**，批量输入需要审计的链接。
3. 启动任务后，监控面板会实时显示 WebSocket 推送的“快照捕获 -> 相似度计算 -> AI 分析”进度。
4. 任务结束后，系统会计算全站的 **平均还原度分数**。

### 方案 C：浏览器插件实时诊断 (适用于内网/高复杂度页面)
1. **安装插件**：
    - 在 Chrome 地址栏输入 `chrome://extensions/`。
    - 开启 **“开发者模式”**。
    - 点击 **“加载解压的扩展程序”**，选择项目根目录下的 `extension` 文件夹。
2. **实时诊断**：
    - 访问任意待测页面，点击插件图标。
    - 在页面中选定元素，点击 **“获取 AI 诊断建议”**。
    - 系统会即时分析元素的 Computed Styles 并对比设计稿。

---

## 3. 技术优势
- **高性能 ODiff 引擎**：采用 Rust 核心，比传统的 Pixelmatch 快 3-5 倍。
- **DDD 领域驱动**：后端结构清晰，业务逻辑与基础设施物理隔离，极易扩展新的 AI 供应商。
- **WebSocket 追踪**：告别轮询，实时掌握大规模批处理进度。
- **智能区域识别**：通过空间聚类算法，将海量差异像素合并为具体的“变更块”。

---

## 4. 常见问题 (FAQ)
- **Q: 为什么还原度总是 0%？**  
  A: 请检查设计稿与实测图的比例是否严重失调。建议视口宽度与设计稿宽度保持一致。
- **Q: 批量任务失败了？**  
  A: 检查网络连接是否通畅，以及 `server/.env` 中的 AI API 密钥是否额度充足。
- **Q: 插件无法捕获截图？**  
  A: 确保后端服务正常运行在 3000 端口，且插件设置中的 API 地址正确。
